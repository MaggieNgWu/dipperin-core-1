language: go
go:
  - 1.x
cache: false #不使用cache
#cache: ccache

notifications:
  email: false

sudo: required # 使用容器进行编译，速度更快
services:
  - docker
git:
  submodules: false # 不运行 git submodules 命令

before_install:
  - docker pull karalabe/xgo-latest
  - docker ps -a
  - go get github.com/karalabe/xgo

install: true # 跳过 install 阶段，因为我已经定义了 before_install。其实 go 项目是需要安装依赖的，只是我放到了下面的 make mycli 命令中做

#script: make travis-test && make compile # 先运行测试，然后交叉编译
script: make compile

deploy:
  provider: releases
  api_key:
    secure: JjhrO/vD2rih2xF/jWylWMYBRHFxua3pFlrmzZ6wMlQmWbvlnrPT+amZvxBlEiOyQYlKHZikPeTYF2i5SFi06nMB2x7gwYRpXFRvgmIXBzDao0FvWL1w2M+PD90EJqsJJAEx8HCAzDXHAWYNk9mwOInMtqt1UuQ0nLicZq1Mf9XFdKnQDuj8672ct1qLZjNcn/B0GsB3Q4J0ObgBEbCd7QG764RnJjCtbFcb0KGeqwVTOJxktQcIEoxwXoVYU3dX6LbOTuhILSf/qENMK7UJh0daJNMfUxUri1Bkwz/XsNaCjAby6cSTtXWTTUlW8zWyDf1I75C4grvm70LWBzSnyO0h2jRSTM475XpeTrv3ttf0266rGIH9KgmyfVSJoEdZBDA+4QDRkFoCeGMPnW0+J3kG86fuMRsfnqswGzS9Bp9SDjuRQLLolIk3Wjcq0AcDlCET7ZGr+Lgqe3rSrEyNV//rR769NpdZF3YbIe5F3jUpYQ+a/5CKgC2oacVmJ8gVNjwXTeQiKpi9YLGNIsjbEvksqyky7hseCKwnbbh2gJ00aB1DVdj91mCgTAvPnFJV5jRqVbCpNgUCPhb/5/+GhwtIYJomYHWxekicr3rxXkjxoYCcG7NimNtRIAiWcfldZ9YikK+4pHY4UdLKg8k8f36bxQxe5qKOEN66LBQVrA4=
  file:
    - "dipperin-core-darwin-10.6-amd64"
    - "dipperin-core-linux-amd64"
    - "dipperin-core-windows-4.0-amd64.exe"
  skip_cleanup: true # 因为要上传可执行文件到 release，所以不能自动把这个文件清除
  on:
    repo: yangchuang123456/dipperin-core
    branch: master
    tags: true   #git tag 时发布
